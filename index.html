<script>
let current = new Date();

/* ===== 台灣國定假日（固定國曆）===== */
function getTaiwanHolidays(year){
  return {
    `${year}-1-1`:"元旦",
    `${year}-2-28`:"和平紀念日",
    `${year}-4-4`:"兒童節",
    `${year}-10-10`:"國慶日"
  };
}

/* ===== 農曆節日（只顯示，不標紅）===== */
const lunarFestivals={
  "1-1":"春節",
  "1-15":"元宵",
  "5-5":"端午",
  "7-7":"七夕",
  "8-15":"中秋",
  "9-9":"重陽"
};

const lunarDayNames=["初一","初二","初三","初四","初五","初六","初七","初八","初九","初十",
"十一","十二","十三","十四","十五","十六","十七","十八","十九","二十",
"廿一","廿二","廿三","廿四","廿五","廿六","廿七","廿八","廿九","三十"];

/* =====（農曆演算法維持原本）===== */
// lunarInfo 與 getLunar() 函式保持你現有版本不變

/* ===== 畫面渲染 ===== */
function renderCalendar(date){
  const year=date.getFullYear();
  const month=date.getMonth();
  const today=new Date();

  const holidays=getTaiwanHolidays(year);

  document.getElementById("monthYear").textContent=`${year}年 ${month+1}月`;
  document.getElementById("todayLine").textContent="今天："+formatTodayLine(today);

  const box=document.getElementById("calendarDays");
  box.innerHTML="";

  let first=new Date(year,month,1).getDay();
  let last=new Date(year,month+1,0).getDate();

  for(let i=0;i<first;i++) box.innerHTML+="<div></div>";

  for(let d=1;d<=last;d++){
    const fullDate=`${year}-${month+1}-${d}`;
    const weekDay=new Date(year,month,d).getDay();

    let cls="day";
    let isHoliday=holidays[fullDate];
    let isWeekend=(weekDay===0||weekDay===6);

    if(isHoliday) cls+=" holiday";
    else if(isWeekend) cls+=" weekend";

    if(d===today.getDate()&&month===today.getMonth()&&year===today.getFullYear())
      cls+=" today";

    const lunar=getLunar(new Date(year,month,d));
    const lunarFest=lunarFestivals[`${lunar.month}-${lunar.day}`]||"";
    const lunarText=lunarFest||(lunar.day===1?`${lunar.month}月`:lunarDayNames[lunar.day-1]);

    box.innerHTML+=`
      <div class="${cls}">
        <div>${d}</div>
        <div class="lunar">${lunarText}</div>
      </div>`;
  }
}

function changeMonth(o){
  current.setMonth(current.getMonth()+o);
  renderCalendar(current);
}

renderCalendar(current);
</script>
